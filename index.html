<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Chemical Cost Calculator</title>
  <style>
    body {
      font-family: sans-serif;
      max-width: 600px;
      margin: 0 auto;
      padding: 2rem;
    }
    input, label {
      display: block;
      margin-bottom: 0.5rem;
      width: 100%;
    }
    input {
      padding: 0.5rem;
    }
    .result {
      background: #f9f9f9;
      border: 1px solid #ccc;
      padding: 1rem;
      margin-top: 1rem;
      border-radius: 5px;
    }
  </style>
</head>
<body>

  <h2>Chemical Cost Calculator</h2>

  <label>Total Mix Size (L)</label>
  <input type="number" id="mixSize" value="75">

  <label>SH Ratio (%)</label>
  <input type="number" id="shRatio" value="50">

  <label>Surfactant Ratio (%)</label>
  <input type="number" id="surfRatio" value="1">

  <label>Scent (ml)</label>
  <input type="number" id="scentMl" value="50">

  <hr/>

  <label>SH Drum Size (L)</label>
  <input type="number" id="shDrumSize" value="20">

  <label>SH Drum Price ($)</label>
  <input type="number" id="shDrumPrice" value="70">

  <label>Surfactant Drum Size (L)</label>
  <input type="number" id="surfDrumSize" value="20">

  <label>Surfactant Drum Price ($)</label>
  <input type="number" id="surfDrumPrice" value="190">

  <label>Scent Drum Size (L)</label>
  <input type="number" id="scentDrumSize" value="25">

  <label>Scent Drum Price ($)</label>
  <input type="number" id="scentDrumPrice" value="60">

  <div class="result" id="result"></div>

  <script>
    function calculateAndSave() {
      const mixSize = parseFloat(document.getElementById('mixSize').value) || 0;
      const shRatio = parseFloat(document.getElementById('shRatio').value) || 0;
      const surfRatio = parseFloat(document.getElementById('surfRatio').value) || 0;
      const scentMl = parseFloat(document.getElementById('scentMl').value) || 0;

      const shDrumSize = parseFloat(document.getElementById('shDrumSize').value) || 1;
      const shDrumPrice = parseFloat(document.getElementById('shDrumPrice').value) || 0;

      const surfDrumSize = parseFloat(document.getElementById('surfDrumSize').value) || 1;
      const surfDrumPrice = parseFloat(document.getElementById('surfDrumPrice').value) || 0;

      const scentDrumSize = parseFloat(document.getElementById('scentDrumSize').value) || 1;
      const scentDrumPrice = parseFloat(document.getElementById('scentDrumPrice').value) || 0;

      const shVolume = mixSize * (shRatio / 100) * 1000;     // in mL
      const surfVolume = mixSize * (surfRatio / 100) * 1000; // in mL

      const shPerLitre = shDrumPrice / shDrumSize;
      const surfPerLitre = surfDrumPrice / surfDrumSize;
      const scentPerLitre = scentDrumPrice / scentDrumSize;

      const costSH = (shVolume / 1000) * shPerLitre;
      const costSurf = (surfVolume / 1000) * surfPerLitre;
      const costScent = (scentMl / 1000) * scentPerLitre;

      const totalCost = costSH + costSurf + costScent;

      document.getElementById('result').innerHTML = `
        <strong>Results for ${mixSize}L Mix</strong><br><br>
        SH Used: ${(shVolume / 1000).toFixed(2)} L — Cost: $${costSH.toFixed(2)}<br>
        Surfactant Used: ${(surfVolume / 1000).toFixed(2)} L — Cost: $${costSurf.toFixed(2)}<br>
        Scent Used: ${(scentMl / 1000).toFixed(2)} L — Cost: $${costScent.toFixed(2)}<br><br>
        <strong>Total Cost: $${totalCost.toFixed(2)}</strong>
      `;

      // Update the latest entry in the mixCalculatorLog
      let log = JSON.parse(localStorage.getItem('mixCalculatorLog')) || [];

      if (log.length > 0) {
        log[log.length - 1].costBreakdown = {
          costSH: costSH.toFixed(2),
          costSurfactant: costSurf.toFixed(2),
          costScent: costScent.toFixed(2),
          totalCost: totalCost.toFixed(2)
        };
        localStorage.setItem('mixCalculatorLog', JSON.stringify(log));
      }
    }

    // Recalculate + save on input
    document.querySelectorAll('input').forEach(input => {
      input.addEventListener('input', calculateAndSave);
    });

    // Run on page load
    window.onload = calculateAndSave;
  </script>

</body>
</html>
